<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CanClimb Data Display</title>
  <script src='https://code.jquery.com/jquery-2.1.3.min.js'></script>
  <script src='http://cykod.github.io/Collection.js/packery.pkgd.min.js'></script>
  <script src='http://cykod.github.io/Collection.js/tabletop.js'></script>
  <script src='http://cykod.github.io/Collection.js/collection.js'></script>
  <link type='text/css' rel='stylesheet' href='style.css' />
</head>
<body>
<!-- <img src="img/BG.jpg" alt="background">
 -->
<nav>
  <div id='filter-bar-wrapper'>
    <div id='filter-bar'>
      <input type='text' id='search' placeholder='search'/>
        <div id="center-buttons">
          <button data-category=""  data-type=""    class='category type selected' id="all-button">All</button>
          <button data-type="MA"  class='type'>MA</button>
          <button data-type="ME"   class='type'>ME</button>
          <button data-type="NH"  class='type'>NH</button>
          <button data-type="VT"   class='type'>VT</button>
          <button data-category="Difficult"   class='category'>Difficult</button>
          <button data-category="Moderate"  class='category'>Moderate</button>
          <button data-category="Easy"   class='category'>Basic</button>
        </div>
    </div>
  </div>
  </nav>

<ul class='collection'>
 


</ul>

<div class='overlay'></div>
<div class='modal'></div>

<script>

// This part is creating the modal and the overlay

  function hideModal() {
    $(".overlay").hide();
    $(".modal").hide();
  };

  function showModal(item) {
  
   $(".modal").empty();
   // so right now this modal is empty 
   
   var $h1 = $("<h1>").text(item.Mountain);
   var $img = $("<img>").attr("src",item.img);
   var $dp = $("<p class='description'>").text(item.Difficulty);
   var $sp = $("<p class='state'>").text(item.State);

// fill these in with the data from my spreadsheet
   $(".modal").append($h1,$img,$sp,$dp);

   /* so when the modal pops up it will display the h1, the img, and the p that is being added by this .append
   (header 1, image and the description) 
   -neds to go in the order you want it in
   -also need to put these in everywehre you see the modal function being called out.*/
   
   $(".overlay").show();
   $(".modal").show();

   //both the modal and the overlay are showing

};


// This function is the one that hides the modal and the over lay after you have clicked off of it




function addItem(item) {
  var $li = $("<div>").addClass("item").addClass(item.State);
  var $h2 = $("<h2 class='name'>").text(item.Mountain);
  var $img = $("<img>").attr("src",item.img);
  var $dp = $("<p class='description'>").text(item.Difficulty);
  var $sp = $("<p class='state'>").text(item.State);

  $li.attr("data-type",item.State); 
  $li.attr("data-category",item.Difficulty);

  $li.append($h2).append($img).append($dp).append($sp);

  $li.on("click",function(e){
      showModal(item);
  });

// This part here lets the computer know that the modal is shown on the "click"

  $(".collection").append($li);
};

// This puts everything with a class of container on the page?

function addItems(data) {
  for(var i=0;i<data.length;i++) {
    addItem(data[i]);
  }
}

//this all down here is the packery function
function callback(data) { 

  addItems(data);

  var $container = $('.collection');
  $container.packery({
    itemSelector: '.item',
    gutter: 10
  });

  var myCollection = $(".item").collection({
    filters: { 
      "title": "h2",
      "category": "[data-category]", 
      "type": "[data-type]"
    },

    update: function() { 
      $container.packery(); 
      setTimeout(function() { $container.packery()},600);
    },
    hide: function($elem) { $elem.hide(); },
    show: function($elem) { $elem.fadeIn(500); },
  });

  $(".category").on("click",function(e) {
      var category = $(this).data("category");
      $("#filter-bar button").removeClass("selected");
      $(this).addClass("selected");
      myCollection.filtered("category",category);
  });

  $(".type").on("click",function(e) {
      var type = $(this).data("type");
      $("#filter-bar button").removeClass("selected");
      $(this).addClass("selected");
      myCollection.filtered("type",type);
  });
// this selects the filtering part in the filter bar

  $("#search").on("change keyup",function(e) {
      myCollection.filtered("title", $(this).val());
  });

  $(".overlay").on("click",function(e) {
      hideModal();
  });
   $("h2").on("click",function(e) {
      showModal();
  });
// when you click on the voerlay the modal will be gone?
}



  Tabletop.init( { key: "https://docs.google.com/spreadsheets/d/1808uI6Ms1QxKmiwcr92kxXt7ZDhTiIWqQdGNN3YbsUQ/pubhtml?gid=0&single=true",
                   callback: callback,
                   simpleSheet: true } )


</script>
	
</body>
</html>
